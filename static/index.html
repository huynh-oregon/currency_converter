<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Currency Converter</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; max-width: 520px; margin: 32px auto; }
    label { display:block; margin: 12px 0 6px; font-weight:600; }
    input, select, button { padding: 8px; font-size: 16px; width: 100%; }
    pre { background:#f6f6f6; padding:12px; border-radius:8px; font-size:14px; }
  </style>
</head>
<body>
  <h1>Currency Converter (USD â†’ EUR/JPY/GBP)</h1>

  <label for="amount">Amount (USD)</label>
  <input id="amount" type="number" min="0" step="0.01" placeholder="e.g., 10.00"/>

  <label for="currency">Select Currency</label>
  <select id="currency" aria-label="Target Currency">
    <!-- options will be populated from /rates -->
  </select>

  <button id="convertBtn" style="margin-top:12px">Convert</button>

  <h3>Result</h3>
  <pre id="result">(no result)</pre>

  <script>
    const API = location.origin; // same host/port as Flask

    async function loadRates() {
      const res = await fetch(`${API}/rates`);
      const data = await res.json();
      const sel = document.getElementById('currency');

      // Build <option> elements using labels when available
      Object.keys(data.rates).forEach(code => {
        const opt = document.createElement('option');
        opt.value = code;
        const label = (data.labels && data.labels[code]) ? `${data.labels[code]} (${code})` : code;
        opt.textContent = label;
        sel.appendChild(opt);
      });
    }

    async function convertNow() {
      const amount = document.getElementById('amount').value;
      const to = document.getElementById('currency').value;

      const res = await fetch(`${API}/convert`, {
        method: 'POST',
        headers: { 'Content-Type':'application/json' },
        body: JSON.stringify({ amount, from_currency: 'USD', to_currency: to })
      });

      const body = await res.json();
      document.getElementById('result').textContent = JSON.stringify(body, null, 2);
    }

    document.getElementById('convertBtn').addEventListener('click', convertNow);
    loadRates();
  </script>
</body>
</html>
